<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>v2_Dashboard PromptX</title>
    

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Executivo de Projetos</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Adicionar SheetJS para processamento de Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0066cc;
            --secondary-color: #f8f9fa;
            --accent-color: #ff6b6b;
            --text-color: #e0e0e0;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --card-radius: 12px;
            --transition-speed: 0.3s;
            --background-color: #272936;
            --card-background: #323442;
            --card-highlight: #3a3c4e;
            --success-color: #10b981;
            --error-color: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            padding: 20px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #1a1c25, #323442);
            color: white;
            border-radius: var(--card-radius);
            box-shadow: 0 4px 20px var(--shadow-color);
        }

        .dashboard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .dashboard-header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* Barra de pesquisa */
        .search-container {
            max-width: 600px;
            margin: 0 auto 30px;
        }

        .search-box {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-icon {
            position: absolute;
            left: 15px;
            color: #a0a0a0;
        }

        #search-input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: none;
            border-radius: 30px;
            background-color: #3a3c4e;
            color: white;
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        #search-input:focus {
            outline: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            background-color: #424559;
        }

        #search-input::placeholder {
            color: #a0a0a0;
        }

        /* Filtros */
        .controls-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .filter-btn {
            background-color: #323442;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-color);
            box-shadow: 0 2px 10px var(--shadow-color);
            transition: all var(--transition-speed);
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px var(--shadow-color);
            background-color: #3e4054;
        }

        .filter-btn.active {
            background-color: var(--primary-color);
            color: white;
        }

        /* Estatísticas e insights */
        .dashboard-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(145deg, #323442, #3a3c4e);
            border-radius: var(--card-radius);
            padding: 25px;
            flex: 1;
            min-width: 220px;
            box-shadow: 0 8px 20px var(--shadow-color);
            text-align: center;
            transition: all var(--transition-speed);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px var(--shadow-color);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #4e9bff, #8c5eff);
        }

        .stat-card:nth-child(2)::before {
            background: linear-gradient(90deg, #ff6b6b, #ffa36b);
        }

        .stat-card:nth-child(3)::before {
            background: linear-gradient(90deg, #36d1dc, #5b86e5);
        }

        .stat-card:nth-child(4)::before {
            background: linear-gradient(90deg, #11998e, #38ef7d);
        }

        .stat-card h3 {
            font-size: 2.5rem;
            margin: 15px 0;
            color: white;
            font-weight: 700;
        }

        .stat-card p {
            font-size: 1.1rem;
            color: #a0a0a0;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        .stat-card-icon {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Insights */
        .insights-container {
            margin-bottom: 30px;
        }

        .insights-container h2 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insights-container h2 i {
            color: #f6c23e;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .insight-card {
            background-color: var(--card-background);
            border-radius: var(--card-radius);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 15px var(--shadow-color);
            transition: all var(--transition-speed);
        }

        .insight-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow-color);
        }

        .insight-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .insight-content {
            flex: 1;
        }

        .insight-content h3 {
            font-size: 0.9rem;
            color: var(--text-color);
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .insight-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: white;
            margin-bottom: 5px;
        }

        .insight-detail {
            font-size: 0.8rem;
            color: var(--text-color);
            opacity: 0.7;
        }
        
        /* Gráfico */
        .chart-container {
            background-color: var(--card-background);
            border-radius: var(--card-radius);
            padding: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px var(--shadow-color);
            height: 250px; /* Altura reduzida para o gráfico horizontal */
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Comparação */
        .comparison-container {
            margin-bottom: 30px;
        }

        .comparison-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .comparison-header h2 {
            font-size: 1.5rem;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-header h2 i {
            color: #36d1dc;
        }

        .comparison-controls {
            display: flex;
            gap: 10px;
        }

        .comparison-btn {
            background-color: #3a3c4e;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-color);
            transition: all var(--transition-speed);
            font-size: 0.9rem;
        }

        .comparison-btn:hover {
            background-color: #424559;
        }

        .comparison-btn.active {
            background-color: #36d1dc;
            color: white;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        /* Cards de projetos */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .project-card {
            background-color: var(--card-background);
            border-radius: var(--card-radius);
            overflow: hidden;
            box-shadow: 0 4px 15px var(--shadow-color);
            transition: all var(--transition-speed);
            position: relative;
        }

        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px var(--shadow-color);
        }

        .project-card-header {
            padding: 20px;
            color: white;
            position: relative;
        }

        .project-card-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0,0,0,0.2), rgba(0,0,0,0));
            z-index: 1;
        }

        .project-card-header h3 {
            position: relative;
            z-index: 2;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .project-card-header p {
            position: relative;
            z-index: 2;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .project-card-body {
            padding: 20px;
        }

        .project-stat {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .project-stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 1.2rem;
        }

        .project-stat-info h4 {
            font-size: 1.1rem;
            margin-bottom: 3px;
        }

        .project-stat-info p {
            font-size: 0.9rem;
            color: #a0a0a0;
        }

        .use-cases {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #3e4054;
        }

        .use-case-tag {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-bottom: 5px;
            transition: all 0.3s ease;
        }

        .use-case-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .use-case-tag i {
            margin-right: 5px;
        }

        /* Checkbox para comparação */
        .compare-checkbox {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 3;
            width: 24px;
            height: 24px;
            cursor: pointer;
            opacity: 0;
        }

       .compare-checkbox-label {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 2;
            width: 24px;
            height: 24px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #a0a0a0;
            transition: all 0.3s ease;
        }

        .compare-checkbox:checked + .compare-checkbox-label {
            background-color: var(--primary-color);
            color: white;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        /* Cores específicas por EM */
        .em-fabricio-lima { background: linear-gradient(135deg, #4e54c8, #8f94fb); }
        .em-diego-souza { background: linear-gradient(135deg, #11998e, #38ef7d); }
        .em-cassiane-santos { background: linear-gradient(135deg, #f46b45, #eea849); }
        .em-raphael-soares { background: linear-gradient(135deg, #614385, #516395); }
        .em-gustavo-fonseca { background: linear-gradient(135deg, #c94b4b, #4b134f); }
        .em-marcelo-nunes { background: linear-gradient(135deg, #0f2027, #2c5364); }
        .em-matheus-weked { background: linear-gradient(135deg, #5614b0, #dbd65c); }
        .em-renata-ponciano { background: linear-gradient(135deg, #ff416c, #ff4b2b); }
        .em-fabio-teixeira { background: linear-gradient(135deg, #1a2a6c, #b21f1f); }
        .em-samantha { background: linear-gradient(135deg, #8e2de2, #4a00e0); }
        .em-default { background: linear-gradient(135deg, #606c88, #3f4c6b); }
        .em-diogo-cordeiro { background: linear-gradient(135deg, #2980b9, #2c3e50); }
        .em-fabricio-laurentiis { background: linear-gradient(135deg, #f953c6, #b91d73); }
        .em-ligia-aparecida-jacob { background: linear-gradient(135deg, #00b09b, #96c93d); }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #424559;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-size: 0.9rem;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #424559 transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Estilo para o input de arquivo oculto */
        #excel-upload {
            display: none;
        }
        
        /* Estilo para o modal de upload */
        .upload-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .upload-modal-content {
            background-color: var(--card-background);
            padding: 30px;
            border-radius: var(--card-radius);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        
        .upload-modal h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
        }
        
        .upload-modal p {
            margin-bottom: 20px;
            color: var(--text-secondary);
        }
        
        .upload-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            margin-right: 10px;
        }
        
        .cancel-btn {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
        }
        
        /* Notificação de sucesso */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--success-color);
            color: white;
            padding: 15px 25px;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .projects-grid, .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .dashboard-stats {
                flex-direction: column;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
            }
            
            .controls-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filters {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-header">
        <h1>Bradesco GEN AI Dashboard PromptX</h1>
        <p>Visão geral dos projetos, usuários treinados e casos de uso</p>
    </div>

    <div class="search-container">
        <div class="search-box">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="search-input" placeholder="Buscar projetos, EMs, casos de uso...">
        </div>
    </div>

    <div class="controls-container">
        <div class="filters">
            <button class="filter-btn active" data-filter="all">Todos os EMs</button>
            <button class="filter-btn" data-filter="fabricio-lima">Fabrício Lima</button>
            <button class="filter-btn" data-filter="diego-souza">Diego de Souza</button>
            <button class="filter-btn" data-filter="cassiane-santos">Cassiane Lima dos Santos</button>
            <button class="filter-btn" data-filter="raphael-soares">Raphael Soares</button>
            <button class="filter-btn" data-filter="renata-ponciano">Renata Ponciano</button>
            <button class="filter-btn" data-filter="fabio-teixeira">Fábio Teixeira</button>
            <button class="filter-btn" data-filter="matheus-weked">Matheus Weked</button>
            <button class="filter-btn" data-filter="marcelo-nunes">Marcelo Nunes</button>
            <button class="filter-btn" data-filter="samantha">Samantha</button>
            <button class="filter-btn" data-filter="gustavo-fonseca">Gustavo Fonseca</button>
            <button class="filter-btn" data-filter="diogo-cordeiro">Diogo Cordeiro</button>
            <button class="filter-btn" data-filter="fabricio-laurentiis">Fabrício de Laurentiis</button>
            <button class="filter-btn" data-filter="ligia-aparecida-jacob">Ligia Aparecida Jacob</button>
        </div>
    </div>

    <div class="dashboard-stats">
        <div class="stat-card">
            <div class="stat-card-icon">
                <i class="fas fa-project-diagram"></i>
            </div>
            <h3 id="total-projects">0</h3>
            <p>Projetos</p>
        </div>
        <div class="stat-card">
            <div class="stat-card-icon">
                <i class="fas fa-users"></i>
            </div>
            <h3 id="total-users">0</h3>
            <p>Profissionais Treinados</p>
        </div>
        <div class="stat-card">
            <div class="stat-card-icon">
                <i class="fas fa-tasks"></i>
            </div>
            <h3 id="total-use-cases">0</h3>
            <p>Casos de Uso</p>
        </div>
        <div class="stat-card">
            <div class="stat-card-icon">
                <i class="fas fa-user-tag"></i>
            </div>
            <h3 id="total-profiles">0</h3>
            <p>Perfis</p>
        </div>
    </div>

    <div class="insights-container">
        <h2><i class="fas fa-lightbulb"></i> Insights</h2>
        <div class="insights-grid" id="insights-grid">
            <!-- Insights serão inseridos aqui via JavaScript -->
        </div>
    </div>

    <div class="chart-container">
        <canvas id="useCaseChart"></canvas>
    </div>

    <div class="comparison-container" id="comparison-container" style="display: none;">
        <div class="comparison-header">
            <h2><i class="fas fa-balance-scale"></i> Comparação de Projetos</h2>
            <div class="comparison-controls">
                <button class="comparison-btn" id="clear-comparison">Limpar</button>
            </div>
        </div>
        <div class="comparison-grid" id="comparison-grid">
            <!-- Projetos para comparação serão inseridos aqui -->
        </div>
    </div>

    <div class="projects-grid" id="projects-container">
        <!-- Cards de projetos serão inseridos aqui via JavaScript -->
    </div>

    <div class="footer">
        <p>Bradesco GEN AI PromptX | Atualizado em: <span id="data-atualizacao"></span></p>
    </div>

    <!-- Input oculto para upload de Excel -->
    <input type="file" id="excel-upload" accept=".xlsx, .xls">
    
    <!-- Modal de upload -->
    <div class="upload-modal" id="upload-modal">
        <div class="upload-modal-content">
            <h3>Importar dados da planilha</h3>
            <p>Selecione um arquivo Excel (.xlsx ou .xls) para atualizar os dados do dashboard.</p>
            <button class="upload-btn" id="select-file-btn">Selecionar arquivo</button>
            <button class="cancel-btn" id="cancel-upload-btn">Cancelar</button>
        </div>
    </div>
    
    <!-- Notificação de sucesso -->
    <div class="notification" id="success-notification">
        Dados atualizados com sucesso!
    </div>

    <script>
        // Função para atualizar a data no rodapé
        function atualizarDataRodape() {
            const dataAtual = new Date();
            
            // Array com os nomes dos meses em português
            const meses = [
                'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            
            // Obtém o dia, mês e ano
            const dia = dataAtual.getDate();
            const mes = meses[dataAtual.getMonth()];
            const ano = dataAtual.getFullYear();
            
            // Formata a data no padrão desejado
            const dataFormatada = `${dia} de ${mes}/${ano}`;
            
            // Atualiza o elemento no rodapé
            const elementoData = document.getElementById('data-atualizacao');
            if (elementoData) {
                elementoData.textContent = dataFormatada;
            }
        }

        // Variáveis para controle de upload
        let keySequence = [];
        const secretCode = "excel"; // A sequência será "excel"
        
        // Detectar combinação de teclas
        document.addEventListener('keydown', function(e) {
            // Adicionar a tecla pressionada à sequência
            keySequence.push(e.key.toLowerCase());
            
            // Manter apenas as últimas 5 teclas
            if (keySequence.length > 5) {
                keySequence.shift();
            }
            
            // Verificar se a sequência corresponde ao código secreto
            if (keySequence.join('') === secretCode) {
                showUploadModal();
                keySequence = []; // Resetar a sequência
            }
        });
        
        // Função para mostrar o modal de upload
        function showUploadModal() {
            document.getElementById('upload-modal').style.display = 'flex';
        }
        
        // Configurar botões do modal
        document.getElementById('select-file-btn').addEventListener('click', function() {
            document.getElementById('excel-upload').click();
        });
        
        document.getElementById('cancel-upload-btn').addEventListener('click', function() {
            document.getElementById('upload-modal').style.display = 'none';
        });
        
        // Processar o arquivo Excel quando selecionado
        document.getElementById('excel-upload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Assumindo que a primeira planilha contém os dados
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    
                 // Converter para JSON
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    // Processar os dados e atualizar o projectsData
                    processExcelData(jsonData);
                    
                    // Fechar o modal
                    document.getElementById('upload-modal').style.display = 'none';
                    
                    // Mostrar notificação de sucesso
                    showNotification();
                    
                    // Limpar o input de arquivo
                    e.target.value = '';
                } catch (error) {
                    console.error("Erro ao processar o arquivo Excel:", error);
                    alert("Ocorreu um erro ao processar o arquivo. Verifique se o formato está correto.");
                }
            };
            reader.readAsArrayBuffer(file);
        });
        
        // Função para processar os dados do Excel
        function processExcelData(jsonData) {
            // Estrutura para armazenar os dados processados
            const projectsMap = new Map();
            const usersMap = new Map();
            
            // Processar cada linha da planilha
            jsonData.forEach(row => {
                // Extrair dados da linha
                const em = row["EM"] || "Não informado";
                const pontoFocal = row["Ponto Focal"] || "Não informado";
                const projeto = row["Projeto"] || "Projeto sem nome";
                const implantacao = row["Implantação"] || "Não definido";
                const perfil = row["Perfil"] || "Não informado";
                const nomeUsuario = row["Nome do usuário"] || "Usuário sem nome";
                const casoUso = row["Caso de Uso"] || "Não informado";
                const interacoes = parseInt(row["Interações"]) || 0;
                const uso = row["Uso"] || "Não interagiu";
                const treinamento = row["Treinamento"] || "";
                
                // Criar chave única para o projeto
                const projectKey = `${projeto}`;
                
                // Criar chave única para o usuário
                const userKey = `${nomeUsuario}-${projeto}`;
                
                // Registrar usuário se ainda não existir
                if (!usersMap.has(userKey) && nomeUsuario !== "Usuário sem nome") {
                    usersMap.set(userKey, {
                        nome: nomeUsuario,
                        projeto: projeto,
                        perfil: perfil,
                        interacoes: interacoes,
                        uso: uso,
                        treinamento: treinamento
                    });
                }
                
                // Atualizar ou criar projeto
                if (!projectsMap.has(projectKey)) {
                    // Criar novo projeto
                    projectsMap.set(projectKey, {
                        name: projeto,
                        em: em,
                        emClass: `em-${em.toLowerCase().replace(/\s+/g, '-').normalize('NFD').replace(/[\u0300-\u036f]/g, '')}`,
                        emFilter: em.toLowerCase().replace(/\s+/g, '-').normalize('NFD').replace(/[\u0300-\u036f]/g, ''),
                        users: 0,
                        profiles: new Set(),
                        useCases: new Set(),
                        wave: implantacao,
                        pontoFocal: pontoFocal,
                        interacoes: 0
                    });
                }
                
                // Atualizar projeto com dados da linha atual
                const projectData = projectsMap.get(projectKey);
                
                // Adicionar perfil se não estiver vazio
                if (perfil && perfil !== "Não informado") {
                    projectData.profiles.add(perfil);
                }
                
                // Adicionar caso de uso se não estiver vazio
                if (casoUso && casoUso !== "Não informado") {
                    projectData.useCases.add(casoUso);
                }
                
                // Adicionar interações
                projectData.interacoes += interacoes;
            });
            
            // Contar usuários por projeto
            usersMap.forEach(user => {
                const projectKey = user.projeto;
                if (projectsMap.has(projectKey)) {
                    projectsMap.get(projectKey).users += 1;
                }
            });
            
            // Converter Map para array e transformar Sets em arrays
            const processedProjects = Array.from(projectsMap.values()).map(project => ({
                ...project,
                profiles: Array.from(project.profiles),
                useCases: Array.from(project.useCases)
            }));
            
            // Atualizar os dados do dashboard
            window.projectsData = processedProjects;
            
            // Recarregar o dashboard com os novos dados
            renderProjects(processedProjects);
            updateStats(processedProjects);
            generateInsights(processedProjects);
            createUseCaseChart(processedProjects);
        }
        
        // Função para mostrar notificação de sucesso
        function showNotification() {
            const notification = document.getElementById('success-notification');
            notification.classList.add('show');
            
            // Esconder após 3 segundos
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Dados dos projetos processados a partir da planilha
        const projectsData = [
            {
                name: "Abertura de Contas",
                em: "Fabrício Lima",
                emClass: "em-fabricio-lima",
                emFilter: "fabricio-lima",
                users: 6,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "Ligia Aparecida",
                interacoes: 91
            },
            {
                name: "AFLUENTES",
                em: "Cassiane Lima dos Santos",
                emClass: "em-cassiane-santos",
                emFilter: "cassiane-santos",
                users: 1,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "Cassiane Lima dos Santos",
                interacoes: 0
            },
            {
                name: "ATACADO",
                em: "Cassiane Lima dos Santos",
                emClass: "em-cassiane-santos",
                emFilter: "cassiane-santos",
                users: 2,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "Luise Mye Kitaoka Santana",
                interacoes: 70
            },
            {
                name: "Bradesco Global Solutions",
                em: "Fabrício Lima",
                emClass: "em-fabricio-lima",
                emFilter: "fabricio-lima",
                users: 5,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 1",
                pontoFocal: "Pedro Aruã",
                interacoes: 115
            },
            {
                name: "Brain",
                em: "Diego de Souza",
                emClass: "em-diego-souza",
                emFilter: "diego-souza",
                users: 22,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 2",
                pontoFocal: "Sirleyd Aparecida mendes dos Santos",
                interacoes: 495
            },
            {
                name: "Consignado",
                em: "Diego de Souza",
                emClass: "em-diego-souza",
                emFilter: "diego-souza",
                users: 11,
                profiles: ["Scrum Master"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Cesar Vasilian Moro",
                interacoes: 150
            },
            {
                name: "CONSIGNADO - E-Social",
                em: "Diego de Souza",
                emClass: "em-diego-souza",
                emFilter: "diego-souza",
                users: 10,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "Cesar Vasilian Moro",
                interacoes: 61
            },
            {
                name: "CONSIGNADO - Mktplace Consignado",
                em: "Diego de Souza",
                emClass: "em-diego-souza",
                emFilter: "diego-souza",
                users: 3,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "Cesar Vasilian Moro",
                interacoes: 12
            },
            {
                name: "CONSIGNADO - Pleito de Priorização INSS",
                em: "Diego de Souza",
                emClass: "em-diego-souza",
                emFilter: "diego-souza",
                users: 1,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "Cesar Vasilian Moro",
                interacoes: 23
            },
            {
                name: "CONSÓRCIO | Consorcio",
                em: "Gustavo Henrique Almeida Fonseca",
                emClass: "em-gustavo-fonseca",
                emFilter: "gustavo-fonseca",
                users: 3,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "João Pedro Santos Vidiri",
                interacoes: 26
            },
            {
                name: "Contadoria",
                em: "Fabrício Lima",
                emClass: "em-fabricio-lima",
                emFilter: "fabricio-lima",
                users: 3,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Piloto",
                pontoFocal: "Fábio Barbosa",
                interacoes: 344
            },
            {
                name: "CRM",
                em: "Raphael Soares",
                emClass: "em-raphael-soares",
                emFilter: "raphael-soares",
                users: 11,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 2",
                pontoFocal: "Yanna Gonzaga",
                interacoes: 321
            },
            {
                name: "CTBI",
                em: "Marcelo Nunes",
                emClass: "em-marcelo-nunes",
                emFilter: "marcelo-nunes",
                users: 2,
                profiles: ["Analista de Negócios"],
                useCases: ["Criação de histórias de usuário"],
                wave: "Piloto",
                pontoFocal: "Roger de Tarso",
                interacoes: 66
            },
            {
                name: "Interestellar",
                em: "Marcelo Nunes",
                emClass: "em-marcelo-nunes",
                emFilter: "marcelo-nunes",
                users: 1,
                profiles: ["DEV"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Marcelo Nunes",
                interacoes: 7
            },
            {
                name: "Interestellar / Contact",
                em: "Marcelo Nunes",
                emClass: "em-marcelo-nunes",
                emFilter: "marcelo-nunes",
                users: 1,
                profiles: ["Scrum Master"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Marcelo Nunes",
                interacoes: 3
            },
            {
                name: "INTERNACIONAL E CÂMBIO",
                em: "Renata Ponciano",
                emClass: "em-renata-ponciano",
                emFilter: "renata-ponciano",
                users: 5,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 3",
                pontoFocal: "Glauber Santos de Carvalho",
                interacoes: 23
            },
            {
                name: "Internet Banking",
                em: "Ligia Aparecida Jacob",
                emClass: "em-ligia-aparecida-jacob",
                emFilter: "ligia-aparecida-jacob",
                users: 2,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Piloto",
                pontoFocal: "Ligia Aparecida Jacob",
                interacoes: 30
            },
            {
                name: "Investimentos",
                em: "Cassiane Lima dos Santos",
                emClass: "em-cassiane-santos",
                emFilter: "cassiane-santos",
                users: 1,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Piloto",
                pontoFocal: "Christopher Noronha",
                interacoes: 125
            },
            {
                name: "Massificado",
                em: "Fábio Teixeira",
                emClass: "em-fabio-teixeira",
                emFilter: "fabio-teixeira",
                users: 9,
                profiles: ["QA", "Scrum Master"],
                useCases: ["Criação de cenários de testes", "Ponto de Função"],
                wave: "Wave 2",
                pontoFocal: "Laila Carvalho",
                interacoes: 241
            },
            {
                name: "Open Finance",
                em: "Raphael Antenor Soares",
                emClass: "em-raphael-soares",
                emFilter: "raphael-soares",
                users: 5,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Piloto",
                pontoFocal: "Lucas Bastos Yousef",
                interacoes: 676
            },
            {
                name: "PIX-CPF",
                em: "Raphael Soares",
                emClass: "em-raphael-soares",
                emFilter: "raphael-soares",
                users: 1,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 2",
                pontoFocal: "Eric Ping",
                interacoes: 76
            },
            {
               name: "PIX-CPJ",
                em: "Raphael Soares",
                emClass: "em-raphael-soares",
                emFilter: "raphael-soares",
                users: 4,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 2",
                pontoFocal: "Eric Ping",
                interacoes: 30
            },
            {
                name: "Plataforma A3C",
                em: "Samantha",
                emClass: "em-samantha",
                emFilter: "samantha",
                users: 13,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 1",
                pontoFocal: "Sara Souto",
                interacoes: 528
            },
            {
                name: "Plataforma Atendimento",
                em: "Fabrício Lima",
                emClass: "em-fabricio-lima",
                emFilter: "fabricio-lima",
                users: 6,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 1",
                pontoFocal: "Thiago Pellegrino",
                interacoes: 25
            },
            {
                name: "Plataforma de segurança Safer",
                em: "Matheus Weked",
                emClass: "em-matheus-weked",
                emFilter: "matheus-weked",
                users: 35,
                profiles: ["QA", "Scrum Master", "SRE", "DEV"],
                useCases: ["Criação de cenários de testes", "Ponto de Função", "Criação de diagrama de sequência"],
                wave: "Piloto",
                pontoFocal: "Roger de Tarso",
                interacoes: 1449
            },
            {
                name: "PROJETO PT-W50594",
                em: "Cassiane Lima dos Santos",
                emClass: "em-cassiane-santos",
                emFilter: "cassiane-santos",
                users: 1,
                profiles: ["Scrum Master"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Cassiane Lima dos Santos",
                interacoes: 14
            },
            {
                name: "Reabilitação Financeira",
                em: "Renata Ponciano",
                emClass: "em-renata-ponciano",
                emFilter: "renata-ponciano",
                users: 16,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 2",
                pontoFocal: "Jota Junior",
                interacoes: 314
            },
            {
                name: "Sala Core",
                em: "Fabio Teixeira",
                emClass: "em-fabio-teixeira",
                emFilter: "fabio-teixeira",
                users: 8,
                profiles: ["QA", "Scrum Master"],
                useCases: ["Criação de cenários de testes", "Ponto de Função"],
                wave: "Wave 2",
                pontoFocal: "Thiago Macedo Marins",
                interacoes: 215
            },
            {
                name: "SCAP",
                em: "Renata Ponciano",
                emClass: "em-renata-ponciano",
                emFilter: "renata-ponciano",
                users: 3,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 2",
                pontoFocal: "Priscila Roque",
                interacoes: 49
            },
            {
                name: "Tesouraria",
                em: "Renata Ponciano",
                emClass: "em-renata-ponciano",
                emFilter: "renata-ponciano",
                users: 1,
                profiles: ["QA"],
                useCases: ["Criação de cenários de testes"],
                wave: "Wave 2",
                pontoFocal: "Priscila Roque",
                interacoes: 2
            },
            {
                name: "Transformação",
                em: "Marcelo Nunes",
                emClass: "em-marcelo-nunes",
                emFilter: "marcelo-nunes",
                users: 7,
                profiles: ["QA", "Analista de Negócios"],
                useCases: ["Criação de cenários de testes", "Criação de histórias de usuário"],
                wave: "Piloto",
                pontoFocal: "Rodrigo Costa",
                interacoes: 225
            },
            {
                name: "VATINTR",
                em: "Diego Cordeiro de Carvalho",
                emClass: "em-diogo-cordeiro",
                emFilter: "diogo-cordeiro",
                users: 1,
                profiles: ["QA"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Claire Regina Zatti",
                interacoes: 7
            },
            {
                name: "Cluster Soluções de Pagamento e Conciliação",
                em: "Diogo Cordeiro",
                emClass: "em-diogo-cordeiro",
                emFilter: "diogo-cordeiro",
                users: 6,
                profiles: ["Scrum Master", "DEV"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Bruna Almeida Conceicao",
                interacoes: 34
            },
            {
                name: "Tribo Contas e Tarifas",
                em: "Fabrício de Laurentiis Lima",
                emClass: "em-fabricio-laurentiis",
                emFilter: "fabricio-laurentiis",
                users: 1,
                profiles: ["Scrum Master"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Ligia Jacob",
                interacoes: 7
            },
            {
                name: "BGS",
                em: "Fabricio de Laurentiis",
                emClass: "em-fabricio-laurentiis",
                emFilter: "fabricio-laurentiis",
                users: 1,
                profiles: ["Scrum Master"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Cibele Mallmann",
                interacoes: 6
            },
            {
                name: "Missões Especiais",
                em: "Renata Ponciano",
                emClass: "em-renata-ponciano",
                emFilter: "renata-ponciano",
                users: 2,
                profiles: ["DEV", "Scrum Master"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Marcio Lage",
                interacoes: 4
            },
            {
                name: "SOLPAGC - REABILITAI | SOLUCOES DE PAGAMENTO E CONCILIACAO",
                em: "Renata Ponciano",
                emClass: "em-renata-ponciano",
                emFilter: "renata-ponciano",
                users: 2,
                profiles: ["Scrum Master", "DEV"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Gilvania da Silva Lima",
                interacoes: 4
            },
            {
                name: "RECR - SOLREAB",
                em: "Renata Ponciano",
                emClass: "em-renata-ponciano",
                emFilter: "renata-ponciano",
                users: 3,
                profiles: ["DEV", "Scrum Master"],
                useCases: ["Ponto de Função"],
                wave: "Wave 3",
                pontoFocal: "Marcio Lage",
                interacoes: 8
            }
        ];

        // Definição de categorias para casos de uso
        const useCaseCategories = {
            "Criação de cenários de testes": {
                color: "#4e73df",
                icon: "fa-vial"
            },
            "Ponto de Função": {
                color: "#1cc88a",
                icon: "fa-calculator"
            },
            "Criação de histórias de usuário": {
                color: "#f6c23e",
                icon: "fa-book"
            },
            "Criação de diagrama de sequência": {
                color: "#e74a3b",
                icon: "fa-project-diagram"
            }
        };

        // Array para armazenar projetos selecionados para comparação
        let selectedProjects = [];

        // Função para renderizar os cards dos projetos
        function renderProjects(projects) {
            const container = document.getElementById('projects-container');
            container.innerHTML = '';

            projects.forEach(project => {
                const card = document.createElement('div');
                card.className = `project-card ${project.emFilter}`;
                card.dataset.id = project.name; // Usar nome como ID único
                
                // Checkbox para comparação
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.className = 'compare-checkbox';
                checkbox.addEventListener('change', function() {
                    toggleProjectComparison(project, this.checked);
                });
                
                // Label para o checkbox
                const checkboxLabel = document.createElement('label');
                checkboxLabel.className = 'compare-checkbox-label';
                checkboxLabel.innerHTML = '<i class="fas fa-balance-scale"></i>';
                
                // Criando o cabeçalho do card
                const header = document.createElement('div');
                header.className = `project-card-header ${project.emClass}`;
                header.innerHTML = `
                    <h3>${project.name}</h3>
                    <p>EM: ${project.em}</p>
                `;
                
                // Criando o corpo do card
                const body = document.createElement('div');
                body.className = 'project-card-body';
                
                // Estatística de usuários
                const usersStat = document.createElement('div');
                usersStat.className = 'project-stat';
                usersStat.innerHTML = `
                    <div class="project-stat-icon" style="background-color: #4e73df;">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="project-stat-info">
                        <h4>${project.users} Profissionais</h4>
                        <p>Treinados</p>
                    </div>
                `;
                
                // Estatística de interações
                const interacoesStat = document.createElement('div');
                interacoesStat.className = 'project-stat';
                interacoesStat.innerHTML = `
                    <div class="project-stat-icon" style="background-color: #e74a3b;">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="project-stat-info">
                        <h4>${project.interacoes} Interações</h4>
                        <p>Total</p>
                    </div>
                `;
              
                
                // Estatística de perfis
                const profilesStat = document.createElement('div');
                profilesStat.className = 'project-stat';
                profilesStat.innerHTML = `
                    <div class="project-stat-icon" style="background-color: #1cc88a;">
                        <i class="fas fa-user-tag"></i>
                    </div>
                    <div class="project-stat-info">
                        <h4>${project.profiles.length} Perfis</h4>
                        <p>${project.profiles.join(', ')}</p>
                    </div>
                `;
                
                // Estatística de implantação
                const waveStat = document.createElement('div');
                waveStat.className = 'project-stat';
                waveStat.innerHTML = `
                    <div class="project-stat-icon" style="background-color: #f6c23e;">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <div class="project-stat-info tooltip">
                        <h4>${project.wave}</h4>
                        <p>Ponto Focal: ${project.pontoFocal}</p>
                        <span class="tooltiptext">Fase de implantação: ${project.wave}</span>
                    </div>
                `;
                
                // Casos de uso
                const useCases = document.createElement('div');
                useCases.className = 'use-cases';
                useCases.innerHTML = '<h4>Casos de Uso:</h4>';
                
                const useCasesList = document.createElement('div');
                project.useCases.forEach(useCase => {
                  const tag = document.createElement('span');
                    tag.className = 'use-case-tag';
                    
                    // Aplicar estilo baseado na categoria
                    const category = useCaseCategories[useCase] || {
                        color: "#858796",
                        icon: "fa-tag"
                    };
                    
                    tag.style.backgroundColor = category.color + "33"; // Adiciona transparência
                    tag.style.color = category.color;
                    tag.style.borderLeft = `3px solid ${category.color}`;
                    
                    tag.innerHTML = `<i class="fas ${category.icon}"></i> ${useCase}`;
                    useCasesList.appendChild(tag);
                });
                
                useCases.appendChild(useCasesList);
                
                // Montando o card
                body.appendChild(usersStat);
                body.appendChild(interacoesStat);
                body.appendChild(profilesStat);
                body.appendChild(waveStat);
                body.appendChild(useCases);
                
                card.appendChild(checkbox);
                card.appendChild(checkboxLabel);
                card.appendChild(header);
                card.appendChild(body);
                
                container.appendChild(card);
            });
        }

        // Função para atualizar as estatísticas gerais
        function updateStats(projects) {
            // Total de projetos
            document.getElementById('total-projects').textContent = projects.length;
            
            // Total de usuários - calculado dinamicamente com base nos projetos filtrados
            const totalUsers = projects.reduce((sum, project) => sum + project.users, 0);
            document.getElementById('total-users').textContent = totalUsers;
            
            // Total de casos de uso únicos
            const uniqueUseCases = new Set();
            projects.forEach(project => {
                project.useCases.forEach(useCase => uniqueUseCases.add(useCase));
            });
            document.getElementById('total-use-cases').textContent = uniqueUseCases.size;
            
            // Total de perfis únicos
            const uniqueProfiles = new Set();
            projects.forEach(project => {
                project.profiles.forEach(profile => uniqueProfiles.add(profile));
            });
            document.getElementById('total-profiles').textContent = uniqueProfiles.size;
        }

    // Função para gerar insights
        function generateInsights(projects) {
            const container = document.getElementById('insights-grid');
            container.innerHTML = '';
            
            // Encontrar projeto com mais usuários
            const projectWithMostUsers = [...projects].sort((a, b) => b.users - a.users)[0];
            
            // Encontrar projeto com mais interações
            const projectWithMostInteractions = [...projects].sort((a, b) => b.interacoes - a.interacoes)[0];
            
            // Encontrar caso de uso mais comum
            const useCaseCounts = {};
            projects.forEach(project => {
                project.useCases.forEach(useCase => {
                    useCaseCounts[useCase] = (useCaseCounts[useCase] || 0) + 1;
                });
            });
            
            const mostCommonUseCase = Object.keys(useCaseCounts).reduce((a, b) => 
                useCaseCounts[a] > useCaseCounts[b] ? a : b, '');
            
            // Encontrar EM com mais projetos
            const emCounts = {};
            projects.forEach(project => {
                emCounts[project.em] = (emCounts[project.em] || 0) + 1;
            });
            
            const emWithMostProjects = Object.keys(emCounts).reduce((a, b) => 
                emCounts[a] > emCounts[b] ? a : b, '');
            
            // Encontrar perfil mais comum
            const profileCounts = {};
            projects.forEach(project => {
                project.profiles.forEach(profile => {
                    profileCounts[profile] = (profileCounts[profile] || 0) + 1;
                });
            });
            
            const mostCommonProfile = Object.keys(profileCounts).reduce((a, b) => 
                profileCounts[a] > profileCounts[b] ? a : b, '');
            
            // Criar cards de insights
            const insights = [
                {
                    title: "Projeto com Mais Profissionais",
                    value: projectWithMostUsers.name,
                    detail: `${projectWithMostUsers.users} profissionais treinados`,
                    icon: "fa-users",
                    color: "#4e73df"
                },
                {
                    title: "Projeto com Mais Interações",
                    value: projectWithMostInteractions.name,
                    detail: `${projectWithMostInteractions.interacoes} interações registradas`,
                    icon: "fa-comments",
                    color: "#e74a3b"
                },
                {
                    title: "Caso de Uso Mais Comum",
                    value: mostCommonUseCase,
                    detail: `Presente em ${useCaseCounts[mostCommonUseCase]} projetos`,
                    icon: "fa-clipboard-list",
                    color: "#1cc88a"
                },
                {
                    title: "EM com Mais Projetos",
                    value: emWithMostProjects,
                    detail: `Gerencia ${emCounts[emWithMostProjects]} projetos`,
                    icon: "fa-user-tie",
                    color: "#f6c23e"
                },
                {
                    title: "Perfil Mais Treinado",
                    value: mostCommonProfile,
                    detail: `Presente em ${profileCounts[mostCommonProfile]} projetos`,
                    icon: "fa-id-badge",
                    color: "#8e2de2"
                }
            ];
            
            // Renderizar insights
            insights.forEach(insight => {
                const card = document.createElement('div');
                card.className = 'insight-card';
                card.innerHTML = `
                    <div class="insight-icon" style="background-color: ${insight.color}33; color: ${insight.color}">
                        <i class="fas ${insight.icon}"></i>
                    </div>
                    <div class="insight-content">
                        <h3>${insight.title}</h3>
                        <div class="insight-value">${insight.value}</div>
                        <div class="insight-detail">${insight.detail}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Função para criar gráfico de casos de uso com barras horizontais
        function createUseCaseChart(projects) {
            // Contar ocorrências de cada caso de uso
            const useCaseCounts = {};
            projects.forEach(project => {
                project.useCases.forEach(useCase => {
                    useCaseCounts[useCase] = (useCaseCounts[useCase] || 0) + 1;
                });
            });
            
            // Ordenar por contagem (do maior para o menor)
            const sortedUseCases = Object.keys(useCaseCounts).sort((a, b) => 
                useCaseCounts[b] - useCaseCounts[a]
            );
            
            // Preparar dados para o gráfico
            const labels = sortedUseCases;
            const data = sortedUseCases.map(useCase => useCaseCounts[useCase]);
            
            // Encontrar o valor máximo para ajustar a escala
            const maxValue = Math.max(...data);
            
            // Gerar cores dinâmicas
            const colors = sortedUseCases.map(useCase => {
                const category = useCaseCategories[useCase] || { color: "#858796" };
                return category.color;
            });
            
            // Criar o gráfico
            const ctx = document.getElementById('useCaseChart').getContext('2d');
            if (window.useCaseChartInstance) {
                window.useCaseChartInstance.destroy();
            }
            
            window.useCaseChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Número de Projetos',
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors.map(color => color),
                        borderWidth: 1,
                        barPercentage: 0.7,
                        categoryPercentage: 0.9
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: {
                        padding: {
                            left: 10,
                            right: 10,
                            top: 10,
                            bottom: 10
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Casos de Uso Mais Frequentes',
                            color: '#e0e0e0',
                            font: {
                                size: 14
                            },
                            padding: {
                                top: 5,
                                bottom: 10
                            }
                        },
                        tooltip: {
                            backgroundColor: '#323442',
                            titleColor: '#e0e0e0',
                            bodyColor: '#e0e0e0',
                            borderColor: '#424559',
                            borderWidth: 1,
                            displayColors: false,
                            titleFont: {
                                size: 12
                            },
                            bodyFont: {
                                size: 11
                            },
                            padding: 8
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            suggestedMax: Math.max(maxValue * 1.1, 5), // Limita o comprimento máximo das barras
                            ticks: {
                                color: '#a0a0a0',
                                font: {
                                    size: 10
                                },
                                padding: 5,
                                stepSize: maxValue <= 10 ? 1 : undefined // Define incrementos de 1 para valores pequenos
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#a0a0a0',
                                font: {
                                    size: 11
                                },
                                padding: 8
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Função para filtrar projetos por EM
        function filterProjects(filter) {
            if (filter === 'all') {
                return projectsData;
            } else {
                return projectsData.filter(project => 
                    project.emFilter === filter
                );
            }
        }

        // Função para buscar projetos
        function searchProjects(query, projects) {
            if (!query) return projects;
            
            query = query.toLowerCase();
            return projects.filter(project => {
                // Buscar no nome do projeto
                if (project.name.toLowerCase().includes(query)) return true;
                
                // Buscar no nome do EM
                if (project.em.toLowerCase().includes(query)) return true;
                
                // Buscar nos casos de uso
                if (project.useCases.some(useCase => useCase.toLowerCase().includes(query))) return true;
                
                // Buscar nos perfis
                if (project.profiles.some(profile => profile.toLowerCase().includes(query))) return true;
                
                // Buscar no ponto focal
                if (project.pontoFocal.toLowerCase().includes(query)) return true;
                
                // Buscar na wave
                if (project.wave.toLowerCase().includes(query)) return true;
                
                return false;
            });
        }

        // Função para alternar seleção de projeto para comparação
        function toggleProjectComparison(project, isSelected) {
            if (isSelected) {
                // Adicionar à lista de selecionados
                selectedProjects.push(project);
            } else {
                // Remover da lista de selecionados
                selectedProjects = selectedProjects.filter(p => p.name !== project.name);
            }
            
            // Atualizar a seção de comparação
            updateComparisonSection();
        }

        // Função para atualizar a seção de comparação
        function updateComparisonSection() {
            const comparisonContainer = document.getElementById('comparison-container');
            const comparisonGrid = document.getElementById('comparison-grid');
            
            // Mostrar ou esconder a seção de comparação
            if (selectedProjects.length > 0) {
                comparisonContainer.style.display = 'block';
                
                // Limpar e renderizar os projetos selecionados
                comparisonGrid.innerHTML = '';
                
                selectedProjects.forEach(project => {
                    const card = document.createElement('div');
                    card.className = `project-card ${project.emFilter}`;
                    
                    // Cabeçalho
                    const header = document.createElement('div');
                    header.className = `project-card-header ${project.emClass}`;
                    header.innerHTML = `
                        <h3>${project.name}</h3>
                        <p>EM: ${project.em}</p>
                    `;
                    
                    // Corpo
                    const body = document.createElement('div');
                    body.className = 'project-card-body';
                    
                    // Estatísticas
                    body.innerHTML = `
                        <div class="project-stat">
                            <div class="project-stat-icon" style="background-color: #4e73df;">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="project-stat-info">
                                <h4>${project.users} Profissionais</h4>
                                <p>Treinados</p>
                            </div>
                        </div>
                        <div class="project-stat">
                            <div class="project-stat-icon" style="background-color: #e74a3b;">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="project-stat-info">
                                <h4>${project.interacoes} Interações</h4>
                                <p>Total</p>
                            </div>
                        </div>
                        <div class="project-stat">
                            <div class="project-stat-icon" style="background-color: #1cc88a;">
                                <i class="fas fa-user-tag"></i>
                            </div>
                            <div class="project-stat-info">
                                <h4>${project.profiles.length} Perfis</h4>
                                <p>${project.profiles.join(', ')}</p>
                            </div>
                        </div>
                        <div class="project-stat">
                            <div class="project-stat-icon" style="background-color: #f6c23e;">
                                <i class="fas fa-rocket"></i>
                            </div>
                            <div class="project-stat-info">
                                <h4>${project.wave}</h4>
                                <p>Ponto Focal: ${project.pontoFocal}</p>
                            </div>
                        </div>
                    `;
                    
                    // Casos de uso
                    const useCases = document.createElement('div');
                    useCases.className = 'use-cases';
                    useCases.innerHTML = '<h4>Casos de Uso:</h4>';
                    
                    const useCasesList = document.createElement('div');
                    project.useCases.forEach(useCase => {
                        const tag = document.createElement('span');
                        tag.className = 'use-case-tag';
                        
                        // Aplicar estilo baseado na categoria
                        const category = useCaseCategories[useCase] || {
                            color: "#858796",
                            icon: "fa-tag"
                        };
                        
                        tag.style.backgroundColor = category.color + "33";
                        tag.style.color = category.color;
                        tag.style.borderLeft = `3px solid ${category.color}`;
                        
                        tag.innerHTML = `<i class="fas ${category.icon}"></i> ${useCase}`;
                        useCasesList.appendChild(tag);
                    });
                    
                    useCases.appendChild(useCasesList);
                    body.appendChild(useCases);
                    
                    card.appendChild(header);
                    card.appendChild(body);
                    
                    comparisonGrid.appendChild(card);
                });
            } else {
                comparisonContainer.style.display = 'none';
            }
        }

        // Configurar os botões de filtro
        document.querySelectorAll('.filter-btn').forEach(button => {
            button.addEventListener('click', function() {
                // Remover classe ativa de todos os botões
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Adicionar classe ativa ao botão clicado
                this.classList.add('active');
                
                // Filtrar e renderizar projetos
                const filter = this.getAttribute('data-filter');
                const filteredProjects = filterProjects(filter);
                renderProjects(filteredProjects);
                updateStats(filteredProjects);
                generateInsights(filteredProjects);
                createUseCaseChart(filteredProjects);
                
                // Atualizar checkboxes para projetos selecionados
                updateComparisonCheckboxes();
            });
        });

     // Configurar a barra de pesquisa
        document.getElementById('search-input').addEventListener('input', function() {
            const query = this.value;
            
            // Obter o filtro atual
            const currentFilter = document.querySelector('.filter-btn.active').getAttribute('data-filter');
            const filteredProjects = filterProjects(currentFilter);
            
            // Buscar nos projetos filtrados
            const searchResults = searchProjects(query, filteredProjects);
            
            // Renderizar resultados
            renderProjects(searchResults);
            updateStats(searchResults);
            generateInsights(searchResults);
            createUseCaseChart(searchResults);
            
            // Atualizar checkboxes para projetos selecionados
            updateComparisonCheckboxes();
        });

        // Configurar botão para limpar comparação
        document.getElementById('clear-comparison').addEventListener('click', function() {
            selectedProjects = [];
            updateComparisonSection();
            
            // Desmarcar todos os checkboxes
            document.querySelectorAll('.compare-checkbox').forEach(checkbox => {
                checkbox.checked = false;
            });
        });

        // Função para atualizar os checkboxes de comparação
        function updateComparisonCheckboxes() {
            // Marcar checkboxes para projetos selecionados
            document.querySelectorAll('.compare-checkbox').forEach(checkbox => {
                const projectCard = checkbox.closest('.project-card');
                const projectId = projectCard.dataset.id;
                
                // Verificar se o projeto está na lista de selecionados
                const isSelected = selectedProjects.some(p => p.name === projectId);
                checkbox.checked = isSelected;
            });
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Atualizar a data no rodapé
            atualizarDataRodape();
            
            renderProjects(projectsData);
            updateStats(projectsData);
            generateInsights(projectsData);
            createUseCaseChart(projectsData);
            
            // Adicionar efeito de hover nos cards
            document.querySelectorAll('.project-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-8px)';
                    this.style.boxShadow = '0 12px 30px rgba(0, 0, 0, 0.3)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.3)';
                });
            });
        });
    </script>
</body>
</html>
    
  </body>
  
</html>
