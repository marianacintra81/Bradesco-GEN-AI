<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard Comparativo - Implantações GenAI</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>

  <style>
    /* Botão Voltar */
    .back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: linear-gradient(135deg, #0033A0, #7B68EE);
      color: #ffffff;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      z-index: 1000;
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }
    .back-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #7B68EE, #0033A0);
    }

    header { position: relative; }

    :root{
      /* Cores de Fundo */
      --background: #0c0e14;
      --card-bg: #1e2130;
      --card-bg-hover: #272936;
      --card-bg-secondary: #151823;

      /* Cores de Texto */
      --text: #ffffff;
      --muted: #a3a8c3;

      /* Cores de Destaque */
      --red-bradesco: #cc0000;
      --blue-bradesco: #0033A0;
      --purple-highlight: #7B68EE;
      --cyan-highlight: #00e5ff;

      /* Cores dos CARDS (e do gráfico de média) */
      --piloto: var(--cyan-highlight);
      --wave1: var(--purple-highlight);
      --wave2: var(--red-bradesco);
      --wave3: #ffa500;
      --wave4: #1dd1a1;

      /* Sombras */
      --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
      --shadow-hover: 0 20px 40px rgba(0, 0, 0, 0.4);
      --radius: 16px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    body {
      background: var(--background);
      color: var(--text);
      padding: 18px;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(0, 51, 160, 0.15) 0%, rgba(0, 51, 160, 0) 70%),
        radial-gradient(circle at 90% 80%, rgba(204, 0, 0, 0.15) 0%, rgba(204, 0, 0, 0) 70%);
    }

    .container { max-width: 1280px; margin: 0 auto; }

    header {
      display: flex;
      justify-content: center;
      margin-bottom: 18px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(255, 255, 255, .08);
    }

    header h1 {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 8px;
      text-align: center;
      background: linear-gradient(135deg, #0033A0, #7B68EE, #cc0000);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    header p { color: var(--muted); text-align: center; }

    /* KPIs */
    .kpis {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 10px;
      margin: 18px 0;
    }

    .kpi {
      position: relative;
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 14px 14px 12px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, .06);
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
      overflow: hidden;
      --accent: #6b7280;
    }

    .kpi:hover {
      transform: translateY(-2px);
      background: var(--card-bg-hover);
      border-color: rgba(255, 255, 255, .12);
      box-shadow: var(--shadow-hover);
    }

    .kpi-head { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
    .chip { width: 32px; height: 32px; border-radius: 999px; display: inline-flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, .06); box-shadow: inset 0 0 0 1px rgba(255, 255, 255, .08); color: var(--accent); }
    .kpi h4 { font-size: 11px; letter-spacing: .3px; color: var(--muted); font-weight: 800; text-transform: uppercase; }
    .kpi .v { font-size: 26px; font-weight: 900; line-height: 1; margin: 4px 0 6px; }
    .kpi small { color: var(--muted); font-size: 12px; }
    .kpi strong { font-weight: 900; color: #fff; }

    .kpi--total { --accent: var(--blue-bradesco); }
    .kpi--ativos { --accent: #22c55e; }
    .kpi--sem { --accent: var(--red-bradesco); }
    .kpi--inter { --accent: var(--cyan-highlight); }
    .kpi--proj { --accent: var(--blue-bradesco); }
    .kpi--adocao { --accent: #22c55e; }

    /* Cabeçalhos das ondas */
    .implantation-headers {
      display: flex;
      gap: 10px;
      margin: 10px 0 12px;
      flex-wrap: wrap;
    }

    .implantation-header {
      flex: 1;
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 10px 12px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, .06);
      transition: all 0.3s ease;
      min-width: 170px;
    }

    .implantation-header:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-hover);
      background: var(--card-bg-hover);
    }

    .implantation-header h2 { font-size: 16px; margin-bottom: 4px; }
    .implantation-header p { font-size: 12px; color: var(--muted); margin: 0; }

    /* 5 colunas: Piloto | Wave 1 | Wave 2 | Wave 3 | Wave 4 */
    .grid {
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    .grid-col { display: flex; flex-direction: column; gap: 10px; min-width: 0; }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, .06);
    }

    .card:hover {
      transform: translateY(-2px);
      background: var(--card-bg-hover);
      border-color: rgba(255, 255, 255, .12);
      box-shadow: var(--shadow-hover);
    }

    .icon { font-size: 18px; margin-bottom: 8px; }
    .val { font-size: 22px; font-weight: 800; margin-bottom: 2px; }
    .lbl { font-size: 12px; color: var(--muted); }
    .sub { font-size: 11px; color: var(--muted); margin-top: 5px; }

    .tag { font-size: 11px; border-radius: 10px; padding: 2px 8px; display: inline-block; margin-top: 4px; font-weight: 700; }
    .tag.piloto { background: rgba(0, 229, 255, .18); color: var(--piloto); }
    .tag.wave1  { background: rgba(123, 104, 238, .18); color: var(--wave1); }
    .tag.wave2  { background: rgba(204,  0,   0, .18); color: var(--wave2); }
    .tag.wave3  { background: rgba(255, 165,   0, .18); color: var(--wave3); }
    .tag.wave4  { background: rgba( 29, 209, 161, .18); color: var(--wave4); }

    /* Gráficos (cards) */
    .chart-wrap {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      margin-top: 10px;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, .06);
    }

    .chart-wrap:hover { box-shadow: var(--shadow-hover); border-color: rgba(255, 255, 255, .12); }

    .chart-title {
      font-weight: 800;
      margin-bottom: 6px;
      background: linear-gradient(135deg, #0033A0, #7B68EE);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      display: inline-block;
    }

    .chart-subtitle { font-size: 13px; color: var(--muted); margin-bottom: 10px; }
    .chart-subtitle .n { color: #fff; font-weight: 800; }
    
    /* Grid para os gráficos em linha */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 10px;
    }

    .chart-card { height: 220px; }

    @media (max-width: 1100px) {
      .kpis { grid-template-columns: repeat(3, 1fr); }
      .grid { grid-template-columns: repeat(2, 1fr); }
      .charts-grid { grid-template-columns: repeat(3, 1fr); }
    }
    @media (max-width: 720px) {
      .kpis { grid-template-columns: repeat(2, 1fr); }
      .charts-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 480px) {
      .kpis { grid-template-columns: 1fr; }
      .grid { grid-template-columns: 1fr; }
      .charts-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div><h1>Adoção GEN AI Bradesco</h1></div>
    </header>

    <!-- Botão Voltar -->
    <a href="https://marianacintra81.github.io/Bradesco-GEN-AI/Menu%20Copilot%20e%20PromptX.html" class="back-button" aria-label="Voltar para a página anterior">
      <i class="fas fa-arrow-left" aria-hidden="true"></i>
    </a>

    <!-- KPIs (gerais recalculados a partir do que você passou) -->
    <section class="kpis">
      <div class="kpi kpi--total">
        <div class="kpi-head"><div class="chip"><i class="fas fa-users"></i></div><h4>Total de Profissionais</h4></div>
        <div class="v" id="k_total">304</div>
        <small>Treinados</small>
      </div>

      <div class="kpi kpi--ativos">
        <div class="kpi-head"><div class="chip"><i class="fas fa-user-check"></i></div><h4>Usuários ativos</h4></div>
        <div class="v" id="k_ativos">276</div>
        <small><strong id="k_adocao">89.5%</strong> de adoção</small>
      </div>

      <div class="kpi kpi--sem">
        <div class="kpi-head"><div class="chip"><i class="fas fa-user-clock"></i></div><h4>Usuários sem interação</h4></div>
        <div class="v" id="k_sem">28</div>
        <small><strong id="k_sem_pct">9.2%</strong> do total</small>
      </div>

      <div class="kpi kpi--inter">
        <div class="kpi-head"><div class="chip"><i class="fas fa-bolt"></i></div><h4>Total de Interações</h4></div>
        <div class="v" id="k_inter">10288</div>
        <small id="k_media_global">Média: 33.8 por usuário</small>
      </div>

      <div class="kpi kpi--proj">
        <div class="kpi-head"><div class="chip">
             <i class="fas fa-diagram-project"></i></div><h4>Projetos envolvidos</h4></div>
        <div class="v" id="k_proj_total">—</div>
        <small>Somatório de projetos mapeados</small>
      </div>

      <div class="kpi kpi--adocao">
        <div class="kpi-head"><div class="chip"><i class="fas fa-gauge-high"></i></div><h4>Taxa de Adoção (geral)</h4></div>
        <div class="v" id="k_taxa_v">90.79%</div>
        <small id="k_taxa_desc">276 de 304 usuários ativos</small>
      </div>
    </section>

    <!-- Cabeçalhos – incluindo Wave 4 -->
    <div class="implantation-headers">
      <div class="implantation-header" style="border-top:4px solid var(--piloto);">
        <h2 style="color:var(--piloto)">Piloto</h2>
      </div>
      <div class="implantation-header" style="border-top:4px solid var(--wave1);">
        <h2 style="color:var(--wave1)">Wave 1</h2>
      </div>
      <div class="implantation-header" style="border-top:4px solid var(--wave2);">
        <h2 style="color:var(--wave2)">Wave 2</h2>
      </div>
      <div class="implantation-header" style="border-top:4px solid var(--wave3);">
        <h2 style="color:var(--wave3)">Wave 3</h2>
      </div>
      <div class="implantation-header" style="border-top:4px solid var(--wave4);">
        <h2 style="color:var(--wave4)">Wave 4</h2>
      </div>
    </div>

    <!-- 10 CARDS: 2 por wave -->
    <section class="grid">
      <!-- Piloto -->
      <div class="grid-col">
        <div class="card">
          <div class="icon"><i class="fas fa-chart-pie" style="color:var(--piloto)"></i></div>
          <div class="val">97.8%</div><div class="lbl">Taxa de Adoção</div>
          <div class="sub"><span class="tag piloto">44 de 45 ativos</span></div>
        </div>
        <div class="card">
          <div class="icon"><i class="fas fa-sync-alt" style="color:var(--piloto)"></i></div>
          <div class="val" id="v_inter_piloto">3388</div><div class="lbl">Interações</div>
          <div class="sub"><strong>Média por total de usuários:</strong> <span id="avg_piloto">75.3</span></div>
        </div>
      </div>

      <!-- Wave 1 -->
      <div class="grid-col">
        <div class="card">
          <div class="icon"><i class="fas fa-chart-pie" style="color:var(--wave1)"></i></div>
          <div class="val">91.3%</div><div class="lbl">Taxa de Adoção</div>
          <div class="sub"><span class="tag wave1">21 de 23 ativos</span></div>
        </div>
        <div class="card">
          <div class="icon"><i class="fas fa-sync-alt" style="color:var(--wave1)"></i></div>
          <div class="val" id="v_inter_w1">838</div><div class="lbl">Interações</div>
          <div class="sub"><strong>Média por total de usuários:</strong> <span id="avg_w1">36.4</span></div>
        </div>
      </div>

      <!-- Wave 2 -->
      <div class="grid-col">
        <div class="card">
          <div class="icon"><i class="fas fa-chart-pie" style="color:var(--wave2)"></i></div>
          <div class="val">97.3%</div><div class="lbl">Taxa de Adoção</div>
          <div class="sub"><span class="tag wave2">72 de 74 ativos</span></div>
        </div>
        <div class="card">
          <div class="icon"><i class="fas fa-sync-alt" style="color:var(--wave2)"></i></div>
          <div class="val" id="v_inter_w2">3412</div><div class="lbl">Interações</div>
          <div class="sub"><strong>Média por total de usuários:</strong> <span id="avg_w2">46.1</span></div>
        </div>
      </div>

      <!-- Wave 3 -->
      <div class="grid-col">
        <div class="card">
          <div class="icon"><i class="fas fa-chart-pie" style="color:var(--wave3)"></i></div>
          <div class="val">90.6%</div><div class="lbl">Taxa de Adoção</div>
          <div class="sub"><span class="tag wave3">106 de 117 ativos</span></div>
        </div>
        <div class="card">
          <div class="icon"><i class="fas fa-sync-alt" style="color:var(--wave3)"></i></div>
          <div class="val" id="v_inter_w3">2303</div><div class="lbl">Interações</div>
          <div class="sub"><strong>Média por total de usuários:</strong> <span id="avg_w3">19.7</span></div>
        </div>
      </div>

      <!-- Wave 4 (corrigida: 29/44) -->
      <div class="grid-col">
        <div class="card">
          <div class="icon"><i class="fas fa-chart-pie" style="color:var(--wave4)"></i></div>
          <div class="val" id="pct_w4">65.9%</div><div class="lbl">Taxa de Adoção</div>
          <div class="sub"><span class="tag wave4" id="tag_w4">29 de 44 ativos</span></div>
        </div>
        <div class="card">
          <div class="icon"><i class="fas fa-sync-alt" style="color:var(--wave4)"></i></div>
          <div class="val" id="v_inter_w4">347</div><div class="lbl">Interações</div>
          <div class="sub"><strong>Média por total de usuários:</strong> <span id="avg_w4">7.9</span></div>
        </div>
      </div>
    </section>

    <!-- Gráficos em linha única -->
    <div class="charts-grid">
      <!-- CARD 1: Top 10 Projetos - Média de Interações -->
      <section class="chart-wrap chart-card">
        <div class="chart-title">Top 10 Projetos - Média de Interações</div>
        <canvas id="topProjectsChart"></canvas>
      </section>

      <!-- CARD 2: Interações por Mês -->
      <section class="chart-wrap chart-card">
        <div class="chart-title">Interações por Mês</div>
        <canvas id="interactionsByMonth"></canvas>
      </section>

      <!-- CARD 3: Interações por Perfil -->
      <section class="chart-wrap chart-card">
        <div class="chart-title">Interações por Perfil</div>
        <canvas id="interactionsByProfile"></canvas>
      </section>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      Chart.register(ChartDataLabels);
      Chart.defaults.color = '#ffffff';
      Chart.defaults.font.family = 'Inter, sans-serif';

      /* ======= DATASETS (conforme você enviou) ======= */
      // Tabela por projeto: profissionais (total), interações (total), média = interações/profissionais
      const projectTable = [
        { proj:"Investimentos", prof:1, inter:154 },
        { proj:"Open Finance", prof:5, inter:755 },
        { proj:"ATACADO", prof:2, inter:251 },
        { proj:"Cluster Soluções de Pagamento e Conciliação", prof:1, inter:118 },
        { proj:"PIX-CPF", prof:1, inter:92 },
        { proj:"Tribo Contas e Tarifas", prof:1, inter:71 },
        { proj:"Plataforma de segurança Safer", prof:38, inter:2440 },
        { proj:"PROJETO PT-W50594", prof:1, inter:48 },
        { proj:"Plataforma A3C", prof:17, inter:793 },
        { proj:"Contadoria", prof:12, inter:733 },
        { proj:"CONSIGNADO - Pleito de Priorização INSS", prof:1, inter:39 },
        { proj:"CRM", prof:11, inter:409 },
        { proj:"BRAIN", prof:28, inter:934 },
        { proj:"Sala Core", prof:8, inter:266 },
        { proj:"Massificado", prof:10, inter:326 },
        { proj:"Transformação", prof:7, inter:234 },
        { proj:"Consignado", prof:12, inter:326 },
        { proj:"Reabilitação Financeira", prof:38, inter:907 },
        { proj:"Abertura de Contas", prof:8, inter:219 },
        { proj:"Internet Banking", prof:2, inter:35 },
        { proj:"VATINTR", prof:1, inter:17 },
        { proj:"Soluçoes PJ", prof:10, inter:229 },
        { proj:"Bradesco Global Solutions", prof:8, inter:151 },
        { proj:"SCAP", prof:3, inter:52 },
        { proj:"Site Gestor", prof:1, inter:26 },
        { proj:"PDPJ", prof:2, inter:25 },
        { proj:"BSPI", prof:8, inter:105 },
        { proj:"PIX-CPJ", prof:4, inter:46 },
        { proj:"Consignado - Portabilidade", prof:3, inter:35 },
        { proj:"Pessoa Fisica", prof:11, inter:115 },
        { proj:"CONSIGNADO - E-Social", prof:10, inter:119 },
        { proj:"INTERNACIONAL E CÂMBIO", prof:6, inter:58 },
        { proj:"CONSÓRCIO | Consorcio", prof:5, inter:41 },
        { proj:"CONSIGNADO - Mktplace Consignado", prof:3, inter:19 },
        { proj:"Tesouraria", prof:3, inter:18 },
        { proj:"Interestellar", prof:2, inter:10 },
        { proj:"MBPF", prof:4, inter:25 },
        { proj:"Plataforma Atendimento", prof:6, inter:29 },
        { proj:"Tribo Canais Assistidos", prof:1, inter:4 },
        { proj:"PEPF", prof:2, inter:6 },
        { proj:"MBPJ", prof:2, inter:5 },
        { proj:"SAFER", prof:1, inter:2 },
        { proj:"Agora Trader", prof:2, inter:1 },
        { proj:"AFLUENTES", prof:1, inter:0 },
        { proj:"Dozer", prof:1, inter:0 }
      ];

      // Interações por mês — exatamente como você pediu
      const monthlyInteractions = [
        { month: "Abril",    interactions: 124 },
        { month: "Maio",     interactions: 540 },
        { month: "Junho",    interactions: 353 },
        { month: "Julho",    interactions: 1157 },
        { month: "Agosto",   interactions: 2435 },
        { month: "Setembro", interactions: 2203 },
        { month: "Outubro",  interactions: 3129 }
      ];

      // Interações por perfil (mantidos como placeholders alinhados ao total ~10.288)
      const profileInteractions = [
        { profile: "QA", interactions: 7198, users: 181 },
        { profile: "Scrum Master", interactions: 2358, users: 82 },
        { profile: "SRE", interactions: 421, users: 5 },
        { profile: "Analista de Negócios", interactions: 167, users: 8 },
        { profile: "DEV", interactions: 144, users: 28 }
      ];

      // Atualiza KPI de projetos a partir da tabela
      document.getElementById('k_proj_total').textContent = projectTable.length.toString();

      /* ====== GRÁFICO 1: Top 10 Projetos — Média de Interações (inter / prof) ====== */
      (function renderTopProjectsChart(){
        const computed = projectTable
          .map(p => ({ ...p, media: p.prof > 0 ? (p.inter / p.prof) : 0 }))
          .sort((a,b) => b.media - a.media);

        const top10 = computed.slice(0, 10);
        const labels = top10.map(d => d.proj);
        const values = top10.map(d => +d.media.toFixed(1));

        // Paleta simples alternada (mantém layout; não depende de "wave")
        const css = v => getComputedStyle(document.documentElement).getPropertyValue(v).trim();
        const palette = [css('--piloto'), css('--wave1'), css('--wave2'), css('--wave3'), css('--wave4')];
        const colors = top10.map((_, i) => palette[i % palette.length]);

        new Chart(document.getElementById('topProjectsChart'), {
          type: 'bar',
          data: {
            labels,
            datasets: [{
              label: 'Média de interações',
              data: values,
              backgroundColor: colors,
              borderColor: colors,
              borderWidth: 1,
              borderRadius: 6,
              categoryPercentage: 0.9,
              barPercentage: 0.9,
              maxBarThickness: 10,
              datalabels: {
                color: '#fff',
                anchor: 'end',
                align: 'end',
                offset: 4,
                formatter: v => v.toLocaleString('pt-BR', { maximumFractionDigits: 1 }),
                font: { weight: 'bold', size: 8 }
              }
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                enabled: true,
                callbacks: {
                  afterLabel: (ctx) => {
                    const p = top10[ctx.dataIndex];
                    return [
                      `Profissionais: ${p.prof}`,
                      `Interações: ${p.inter.toLocaleString('pt-BR')}`,
                      `Média: ${(p.inter/p.prof).toFixed(0)}`
                    ];
                  }
                }
              }
            },
            scales: {
              x: { grid: { display: false }, ticks: { autoSkip: false, maxRotation: 45, minRotation: 45, font: { size: 8 } } },
              y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
            }
          }
        });
      })();

      /* ====== GRÁFICO 2: Interações por Mês (valores exatos) ====== */
      (function renderInteractionsByMonth() {
        const labels = monthlyInteractions.map(item => item.month);
        const values = monthlyInteractions.map(item => item.interactions);

        const maxVal = Math.max(...values);
        const niceMax = Math.ceil((maxVal * 1.12) / 500) * 500;

        new Chart(document.getElementById('interactionsByMonth'), {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [
              {
                label: 'Interações Mensais',
                data: values,
                backgroundColor: 'rgba(123, 104, 238, 0.7)',
                borderColor: 'rgba(123, 104, 238, 1)',
                borderWidth: 1,
                borderRadius: 6,
                categoryPercentage: 0.8,
                barPercentage: 0.8,
                maxBarThickness: 25,
                datalabels: {
                  color: '#fff',
                  anchor: 'end',
                  align: 'end',
                  offset: 4,
                  formatter: v => v.toLocaleString('pt-BR'),
                  font: { weight: 'bold', size: 8 }
                }
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                enabled: true,
                callbacks: {
                  label: ctx => `Interações: ${ctx.parsed.y.toLocaleString('pt-BR')}`
                }
              }
            },
            scales: {
              x: { grid: { display: false } },
              y: {
                beginAtZero: true,
                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                max: niceMax,
                ticks: { stepSize: 500 }
              }
            }
          }
        });
      })();

      /* ====== GRÁFICO 3: Interações por Perfil (placeholders consistentes) ====== */
      (function renderInteractionsByProfile() {
        const labels = profileInteractions.map(item => item.profile);
        const values = profileInteractions.map(item => item.interactions);
        const css = v => getComputedStyle(document.documentElement).getPropertyValue(v).trim();
        const colors = [
          css('--piloto'),
          css('--wave1'),
          css('--wave2'),
          css('--wave3'),
          css('--wave4')
        ];

        new Chart(document.getElementById('interactionsByProfile'), {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [
              {
                label: 'Interações',
                data: values,
                backgroundColor: colors,
                borderColor: colors,
                borderWidth: 1,
                borderRadius: 6,
                categoryPercentage: 0.8,
                barPercentage: 0.8,
                maxBarThickness: 30,
                datalabels: {
                  color: '#fff',
                  anchor: 'end',
                  align: 'end',
                  offset: 4,
                  formatter: v => v.toLocaleString('pt-BR'),
                  font: { weight: 'bold', size: 8 }
                }
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                enabled: true,
                callbacks: {
                  afterLabel: (tooltipItem) => {
                    const idx = tooltipItem.dataIndex;
                    const p = profileInteractions[idx];
                    const percentage = ((p.interactions / values.reduce((a, b) => a + b, 0)) * 100).toFixed(1);
                    return [
                      `Usuários: ${p.users}`,
                      `Média por usuário: ${(p.interactions / p.users).toFixed(1)}`,
                      `Percentual: ${percentage}%`
                    ];
                  }
                }
              }
            },
            scales: {
              x: { grid: { display: false } },
              y: {
                beginAtZero: true,
                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                max: 8000,
                ticks: { stepSize: 1000 }
              }
            }
          }
        });
      })();
    });

    function goBack() {
      window.location.href = 'https://marianacintra81.github.io/Bradesco-GEN-AI/GenAI%20Hub%20%20Centro%20de%20Inovacao.html';
    }
  </script>
</body>
</html>
